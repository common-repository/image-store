/**
 * Image Store - Admin pricing script
 *
 * @file pricing.js
 * @package Image Store
 * @author Hafid Trujillo
 * @copyright 2010-2016
 * @filesource  wp-content/plugins/image-store/_js/pricing.js
 * @since 3.2.1
 */

 jQuery(function(t){if(jQuery().datepicker){var e={altFormat:"yy-mm-dd",dateFormat:imslocal.dateformat};t("#starts").datepicker(t.extend(e,{altField:"#start_date"})),t("#expires").datepicker(t.extend(e,{altField:"#expiration_date"}))}t("#poststuff").delegate(".postbox .handlediv","click",function(){var e=window.location.hash.replace("#",""),i=""==e?"ims_pricelists":"ims_"+e;t(this).parent(".postbox").toggleClass("closed");var a=t(".postbox.closed").map(function(){return this.id}).get().join(",");t.post(ajaxurl,{action:"closed-postboxes",closed:a,hidden:"",closedpostboxesnonce:t("#closedpostboxesnonce").val(),page:i})}),t("#promo_type").change(function(){var e=t('input[name="discount"]');3==t(this).val()?e.attr({disabled:"disabled"}):e.removeAttr("disabled")}),t("#price-list-box").delegate("input.downloadable","click",function(){var e=t(this).parents("tr.size").find("td").eq(1);t(this).is(":checked")?e.append("<em>"+imslocal.download+"</em>"):e.find("em").remove()}),t("#poststuff").delegate(".itemtop a","click",function(){var e=t(this).parents(".ims-table").find(".content");e.is(":hidden")?(t(this).html("[-]"),e.show()):(t(this).html("[+]"),e.hide())}),t("#poststuff").delegate("tbody td.x","click",function(){var e=t(this).parents("tbody");e.find("tr.row").length<=1&&e.find("tr.filler").show(),t(this).parent().remove()}),t("#packages").delegate(".trash","click",function(){return confirm(imslocal.deletepackage)?(id=t(this).parent().find(".packageid").val(),t.get(imslocal.imsajax,{postid:id,action:"deletepackage",_wpnonce:imslocal.nonceajax},function(){t("#package-list-"+id).remove()}),!1):!1}),t("#pricelists").delegate(".trash","click",function(){if(!confirm(imslocal.deletelist))return!1;var e=t(this).parent().find(".listid").val();return t.get(imslocal.imsajax,{postid:e,action:"deletelist",_wpnonce:imslocal.nonceajax},function(){t("#ims-list-"+e).remove()}),!1}),jQuery().sortable&&t(".pricelists tbody.sizes,.pricelists tbody.colors,.package-list tbody.packages,.pricelists tbody.finishes").each(function(){t(this).sortable({axis:"y",cursor:"move",helper:"clone",containment:this,items:"tr:not(.header)",placeholder:"widget-placeholder",stop:function(e,a){i=0,t(this).find(".filler").hide(),type=t(this).attr("class").split(" ")[0],t(this).find(".row").each(function(){var e=type+"["+i+"]";t(this).find(".unit").attr("name",e+"[unit]"),t(this).find("input.id").attr("name",e+"[ID]"),t(this).find("input.code").attr("name",e+"[code]"),t(this).find("input.name").attr("name",e+"[name]"),t(this).find("input.price").attr("name",e+"[price]"),t(this).find("select.type").attr("name",e+"[type]"),t(this).find("input.count").attr("name",e+"[count]"),t(this).find("input.downloadable").attr("name",e+"[download]"),i++})}})}),jQuery().draggable&&(t("#pricelists .finish").draggable({helper:"clone",revert:"invalid",connectToSortable:"#price-list-box .finishes"}),t("#color_options .color").draggable({helper:"clone",revert:"invalid",connectToSortable:"#price-list-box .colors"}),t("#pricelists .sizes-list .size,#price-list-package .packages").draggable({helper:"clone",revert:"invalid",connectToSortable:".pricelists .sizes"}),t("#packages .sizes-list .size").draggable({helper:"clone",revert:"invalid",connectToSortable:".package-list .packages"})),t(".ims-table tbody.content").each(function(){t(this).find(".row").length<=0&&t(this).find("tr.filler").show()}),t("#poststuff").delegate(".addimagesize,.addfinish,.addcoloropt,.addshipping,.addcolorfilter","click",function(e){e.preventDefault();var i=t(this).parents(".postbox"),a=i.find(".row").length,n=i.find(".copyrow"),s=n.attr("title"),o=s+"["+a+"]",r=n.clone().removeAttr("title").removeClass("copyrow").addClass(" row");r.find("input.name").attr("name",o+"[name]"),r.find("input.price").attr("name",o+"[price]"),r.find("input.width").attr("name",o+"[w]"),r.find("input.height").attr("name",o+"[h]"),r.find("select.unit").attr("name",o+"[unit]"),r.find("input.code").attr("name",o+"[code]"),r.find("select.type").attr("name",o+"[type]"),r.find("input.colorize").attr("name",o+"[colorize]"),r.find("input.contrast").attr("name",o+"[contrast]"),r.find("input.grayscale").attr("name",o+"[grayscale]"),r.find("input.brightness").attr("name",o+"[brightness]"),n.before(r)}),t(".ims-table tbody.content").each(function(){t(this).find(".row").length<=0&&t(this).find("tr.filler").show()})});
